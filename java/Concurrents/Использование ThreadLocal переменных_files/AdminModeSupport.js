var disableBannerEditor,enableBannerEditor,enterAdminMode,exitAdminMode,operationInProgress,submitData;jQuery((function(_this){return function(){return $(document).ready(function(){if(typeof Storage!=="undefined"){if($('#toggle-admin-mode').length>0){if("true"===sessionStorage.adminMode){return enterAdminMode();}else{return exitAdminMode();}}else{return sessionStorage.adminMode=false;}}else{}});};})(this));operationInProgress=false;enterAdminMode=function(){var appNameContainer,oldApplicationName;appNameContainer=$('#application-name-container');oldApplicationName=appNameContainer.text();$('#application-icon').addClass("glyphicon glyphicon-pencil").click(function(e){e.preventDefault();return appNameContainer.focus();});$('#main-rss-link').hide();appNameContainer.attr('contenteditable',"true").click(function(e){return e.preventDefault();}).keypress(function(e){if(e.keyCode===13){e.preventDefault();return submitData(this.textContent);}}).keyup((function(e){if(e.keyCode===27){return appNameContainer.text(oldApplicationName).blur();}}));sessionStorage.adminMode=true;$('#toggle-admin-mode').text("Exit admin mode").closest('li').click(function(e){exitAdminMode();return e.preventDefault();});return enableBannerEditor();};submitData=function(newName){if(!operationInProgress){if(newName.length>256){return showFailureNotification("Application name cannot exceed 256 chars");}else{operationInProgress=true;return $.ajax({type:"POST",url:$('#toggle-admin-mode').closest('a').attr('data-href'),contentType:'application/json',data:JSON.stringify({instanceName:newName}),statusCode:{401:function(){showFailureNotification("Your session has ended. Please refresh the page.");return $('#application-name-container').focus();}},success:function(){showSuccessNotification("Application name has been updated");return $('#application-name-container').blur();},error:function(data){showFailureNotification(data);return $('#application-name-container').focus();},complete:function(){return operationInProgress=false;}});}}};enableBannerEditor=function(){$('.banner-control').show();$('.page-banner').addClass("banner-border");return $('button[data-banner-submit-href]').each(function(){return $(this).click((function(_this){return function(){var content;content=$(_this).prevAll('input').val().trim();if(content.indexOf("http://codepen.io/")===0||content===""){return $.ajax({type:"POST",url:$(_this).attr('data-banner-submit-href'),contentType:'application/json',data:JSON.stringify({'codepenId':content}),success:function(){return showSuccessNotification("Banner id has been updated, please refresh the page");},error:function(data){return showFailureNotification(data);}});}else{return showFailureNotification("This id does not look like a correct Codepen URL");}};})(this));});};exitAdminMode=function(){sessionStorage.adminMode=false;$('#main-rss-link').show();$('#application-icon').removeClass("glyphicon glyphicon-pencil").unbind('click');$('#application-name-container').attr('contenteditable',"false").unbind('click').removeAttr('keypress').removeAttr('keyup');$('#toggle-admin-mode').text("Enter admin mode").closest('li').click(function(e){enterAdminMode();return e.preventDefault();});return disableBannerEditor();};disableBannerEditor=function(){$('.banner-control').hide();return $('.page-banner').removeClass("banner-border");};//# sourceMappingURL=AdminModeSupport.js.map
